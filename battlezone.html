<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Battlezone</title>

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  /* Background image */
  background: url("images/A.jpeg") no-repeat center center fixed;
  background-size: cover;
  color:white;
}

.overlay{
  min-height:100vh;
  padding:15px;
}

/* Header */
.header{
  text-align:center;
  font-size:24px;
  font-weight:bold;
  margin-bottom:15px;
}

/* Input/Post Boxes with stronger transparency */
.container textarea, .container input, .container button{
  background: rgba(0,0,0,0.5); /* stronger than before */
  color:white; /* text very visible */
  border:none;
  border-radius:12px;
  padding:10px;
  margin-bottom:10px;
  font-weight:bold;
}

/* Post Boxes */
.post{
  background: rgba(0,0,0,0.45); /* slightly darker so text stands out */
  color:white;
  margin-top:15px;
  padding:15px;
  border-radius:12px;
  font-weight:bold;
}

/* Poll Options */
.poll-option{
  background: rgba(0,0,0,0.35);
  padding:8px;
  margin-top:6px;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
  color:white;
}

/* Reactions */
.reactions{
  margin-top:10px;
  display:flex;
  flex-wrap:wrap;
  gap:6px;
}
.reactions span{
  cursor:pointer;
  font-size:18px;
}
</style>
</head>

<body>
<div class="overlay">

<div class="header">Battlezone</div>

<div class="container">
  <textarea id="text" placeholder="Write something clean..."></textarea>

  <input id="pollQ" placeholder="Poll question (optional)">
  <input id="pollA" placeholder="Option 1">
  <input id="pollB" placeholder="Option 2">

  <button onclick="post()">POST</button>

  <div id="feed"></div>
</div>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-database-compat.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyB9bgMrAdjNKet_RIzI0msXsQGdkLH3ZiM",
  authDomain: "animeunity-30c1f.firebaseapp.com",
  databaseURL: "https://animeunity-30c1f-default-rtdb.firebaseio.com",
  projectId: "animeunity-30c1f"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Abuse filter (English + Hindi patterns)
// Strict abuse filter (English + Hindi patterns)
const abusePatterns = [
  // ENGLISH (50+ patterns)
  /(f+[\W_]*u+[\W_]*c+[\W_]*k+)/i,
  /(s+[\W_]*h+[\W_]*i+[\W_]*t+)/i,
  /(b+[\W_]*i+[\W_]*t+[\W_]*c+[\W_]*h+)/i,
  /(a+[\W_]*s+[\W_]*s+[\W_]*h+[\W_]*o+[\W_]*l+[\W_]*e+)/i,
  /(d+[\W_]*i+[\W_]*c+[\W_]*k+)/i,
  /(c+[\W_]*o+[\W_]*c+[\W_]*k+)/i,
  /(m+[\W_]*o+[\W_]*t+[\W_]*h+[\W_]*e+[\W_]*r+[\W_]*f+[\W_]*u+[\W_]*c+[\W_]*k+)/i,
  /(r+[\W_]*e+[\W_]*t+[\W_]*a+[\W_]*r+[\W_]*d+)/i,
  /(i+[\W_]*d+[\W_]*i+[\W_]*o+[\W_]*t+)/i,
  /(s+[\W_]*t+[\W_]*u+[\W_]*p+[\W_]*i+[\W_]*d+)/i,
  /(l+[\W_]*o+[\W_]*s+[\W_]*e+[\W_]*r+)/i,
  /(n+[\W_]*o+[\W_]*b+[\W_]*o+)/i,
  /(d+[\W_]*u+[\W_]*m+[\W_]*b+)/i,
  /(t+[\W_]*r+[\W_]*a+[\W_]*s+[\W_]*h+)/i,
  /(c+[\W_]*r+[\W_]*a+[\W_]*p+)/i,
  /(j+[\W_]*e+[\W_]*r+[\W_]*k+)/i,
  /(s+[\W_]*l+[\W_]*u+[\W_]*t+)/i,
  /(w+[\W_]*h+[\W_]*o+[\W_]*r+[\W_]*e+)/i,
  /(p+[\W_]*e+[\W_]*r+[\W_]*v+[\W_]*e+[\W_]*r+[\W_]*t+)/i,
  /(f+[\W_]*r+[\W_]*e+[\W_]*a+[\W_]*k+)/i,
  /(p+[\W_]*s+[\W_]*y+[\W_]*c+[\W_]*h+[\W_]*o+)/i,
  /(n+[\W_]*a+[\W_]*s+[\W_]*t+[\W_]*y+)/i,
  /(g+[\W_]*a+[\W_]*r+[\W_]*b+[\W_]*a+[\W_]*g+[\W_]*e+)/i,
  /(t+[\W_]*o+[\W_]*x+[\W_]*i+[\W_]*c+)/i,
  /(r+[\W_]*a+[\W_]*c+[\W_]*i+[\W_]*s+[\W_]*t+)/i,
  /(s+[\W_]*e+[\W_]*x+[\W_]*i+[\W_]*s+[\W_]*t+)/i,
  /(a+[\W_]*b+[\W_]*u+[\W_]*s+[\W_]*e+)/i,
  /(h+[\W_]*a+[\W_]*t+[\W_]*e+)/i,
  /(d+[\W_]*i+[\W_]*e+)/i,
  /(k+[\W_]*i+[\W_]*l+[\W_]*l+)/i,
  /(d+[\W_]*a+[\W_]*m+[\W_]*n+)/i,
  /(b+[\W_]*l+[\W_]*o+[\W_]*o+[\W_]*d+[\W_]*y+)/i,
  /(w+[\W_]*o+[\W_]*r+[\W_]*t+[\W_]*h+[\W_]*l+[\W_]*e+[\W_]*s+[\W_]*s+)/i,
  /(p+[\W_]*a+[\W_]*t+[\W_]*h+[\W_]*e+[\W_]*t+[\W_]*i+[\W_]*c+)/i,
  /(f+[\W_]*a+[\W_]*i+[\W_]*l+[\W_]*u+[\W_]*r+[\W_]*e+)/i,
  /(c+[\W_]*h+[\W_]*o+[\W_]*t+)/i,
  /(t+[\W_]*o+[\W_]*i+[\W_]*l+[\W_]*e+[\W_]*t+)/i,
  /(p+[\W_]*i+[\W_]*s+[\W_]*s+)/i,
  /(s+[\W_]*c+[\W_]*u+[\W_]*m+)/i,
  /(u+[\W_]*g+[\W_]*l+[\W_]*y+)/i,
  /(b+[\W_]*a+[\W_]*d+)/i,
  /(c+[\W_]*r+[\W_]*a+[\W_]*z+[\W_]*y+)/i,
  /(n+[\W_]*e+[\W_]*r+[\W_]*d+)/i,
  /(w+[\W_]*i+[\W_]*m+[\W_]*p+)/i,
  /(f+[\W_]*a+[\W_]*n+[\W_]*k+)/i,

  // HINDI / HINGLISH (50+ patterns)
  /(m+a+d+a+r+c+h+o+d+)/i,
  /(b+e+h+e+n+c+h+o+d+)/i,
  /(b+h+o+s+d+i+k+e+)/i,
  /(c+h+u+t+i+y+a+)/i,
  /(c+h+u+t+)/i,
  /(g+a+a+n+d+)/i,
  /(l+u+n+d+)/i,
  /(l+o+d+a+)/i,
  /(h+a+r+a+m+i+/i),
  /(k+a+m+i+n+a+/i),
  /(k+u+t+t+e+)/i,
  /(k+u+t+t+i+/i),
  /(s+a+a+l+a+/i),
  /(r+a+n+d+i+/i),
  /(b+h+a+i+n+s+/i),
  /(b+h+a+d+w+a+/i),
  /(g+a+n+d+u+/i),
  /(u+l+l+u+/i),
  /(p+a+g+a+l+/i),
  /(n+a+l+a+y+a+k+/i),
  /(b+a+k+w+a+s+/i),
  /(g+h+a+t+i+y+a+/i),
  /(f+a+l+t+u+/i),
  /(b+a+d+b+a+k+h+t+/i),
  /(h+a+r+a+m+z+a+d+a+/i),
  /(n+i+k+a+m+m+a+/i),
  /(c+h+o+r+/i),
  /(d+h+o+k+e+b+a+a+z+/i),
  /(g+i+r+a+h+u+a+/i),
  /(k+a+m+e+e+n+a+/i),
  /(b+e+w+a+k+o+o+f+/i),
  /(b+u+t+h+i+a+/i),
  /(l+a+f+a+n+g+a+/i),
  /(a+w+a+r+a+/i),
  /(j+a+h+i+l+/i),
  /(g+a+w+a+r+/i),
  /(b+a+d+t+a+m+e+e+z+/i),
  /(b+a+t+a+m+e+e+z+/i),
  /(b+e+s+h+a+r+a+m+/i),
  /(n+a+m+a+k+h+a+r+a+m+/i),
  /(g+h+a+m+a+n+d+i+/i),
  /(z+a+l+i+m+/i),
  /(b+u+r+a+/i),
  /(g+a+l+i+/i),
  /(b+a+d+d+u+a+/i),
  /(s+h+a+i+t+a+n+/i),
  /(k+h+a+r+a+b+/i),
  /(g+u+s+s+a+/i),
  /(t+a+m+a+n+/i)
];

function hasAbuse(text){
  return abusePatterns.some(p=>p.test(text.toLowerCase()));
}

// Post text/poll
function post(){
  const t = document.getElementById("text").value.trim();
  if(!t) return;

  if(hasAbuse(t)){
    alert("âŒ Post blocked: inappropriate words found");
    return;
  }

  const pq = document.getElementById("pollQ").value.trim();
  const pa = document.getElementById("pollA").value.trim();
  const pb = document.getElementById("pollB").value.trim();

  const postObj = {
    text: t,
    time: Date.now(),
    poll: pq && pa && pb ? {
      q: pq,
      a: {t:pa,c:0},
      b: {t:pb,c:0},
      voted:{}
    } : null,
    reactions: {}
  };

  db.ref("battlezone").push(postObj);

  document.getElementById("text").value="";
  document.getElementById("pollQ").value="";
  document.getElementById("pollA").value="";
  document.getElementById("pollB").value="";
}

// 50 emoji reactions
const emojiList = ["ðŸ˜€","ðŸ˜‚","ðŸ˜","ðŸ‘","ðŸ”¥","ðŸ˜®","ðŸ˜¢","ðŸ˜¡","ðŸ¥³","ðŸ¤¯","ðŸ¤©","ðŸ¥°","ðŸ˜Ž","ðŸ¤”","ðŸ˜¤","ðŸ’¯","ðŸ’¥","ðŸ™Œ","ðŸ‘","ðŸ¤","ðŸŽ‰","ðŸ’–","ðŸ«¶","ðŸ¥º","ðŸ¤«","ðŸ˜±","ðŸ˜œ","ðŸ¤ª","ðŸ˜‡","ðŸ˜","ðŸ¤¤","ðŸ¥µ","ðŸ¥¶","ðŸ˜ˆ","ðŸ‘»","ðŸ’€","â˜ ï¸","ðŸ¤¡","ðŸ¤ ","ðŸ¤‘","ðŸ¤","ðŸ¤§","ðŸ˜·","ðŸ« ","ðŸ¤®","ðŸ¤¬","ðŸ¤¯","ðŸ¤©","ðŸ«¡"];

function react(postId, emoji){
  db.ref("battlezone/"+postId+"/reactions/"+emoji).transaction(v => (v||0)+1);
}

// Poll one-vote-per-user
function vote(postId,opt){
  const uid = sessionStorage.getItem("uid") || Date.now()+Math.random();
  sessionStorage.setItem("uid",uid);

  db.ref(`battlezone/${postId}/poll/voted/${uid}`).get().then(s=>{
    if(s.exists()) return alert("âŒ You already voted for this poll");
    db.ref(`battlezone/${postId}/poll/${opt}/c`).transaction(v=> (v||0)+1);
    db.ref(`battlezone/${postId}/poll/voted/${uid}`).set(true);
  });
}

// Load posts
db.ref("battlezone").on("value", snap=>{
  const feedDiv = document.getElementById("feed");
  feedDiv.innerHTML="";
  const d = snap.val();
  if(!d) return;

  Object.keys(d).reverse().forEach(id=>{
    const p = d[id];
    let pollHTML="";
    if(p.poll){
      pollHTML=`
        <div>${p.poll.q}</div>
        <div class="poll-option" onclick="vote('${id}','a')">${p.poll.a.t} (${p.poll.a.c})</div>
        <div class="poll-option" onclick="vote('${id}','b')">${p.poll.b.t} (${p.poll.b.c})</div>
      `;
    }

    let reactionsHTML = emojiList.map(e=>`<span onclick="react('${id}','${e}')">${e} ${p.reactions && p.reactions[e]||0}</span>`).join(' ');

    feedDiv.innerHTML += `<div class="post">
      <div>${p.text}</div>
      ${pollHTML}
      <div class="reactions">${reactionsHTML}</div>
    </div>`;
  });
});
</script>
</body>
</html>
