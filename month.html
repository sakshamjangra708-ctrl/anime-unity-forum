<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Anime Posting Page</title>

<style>
body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background: url("images/Boss.jpeg") center / cover fixed;
    color: white;
    overflow-x: hidden;
}

.summary-box {
    margin: 18px;
    padding: 15px;
    background: rgba(255,255,255,0.08);
    border-radius: 12px;
    border:1px solid rgba(255,255,255,0.15);
    font-size:12px;
    user-select:none;
}

.input-box {
    width: 90%;
    margin: 10px auto;
    display: none;
    flex-direction: column;
    gap: 10px;
}

.input-box input,
.input-box textarea {
    padding: 8px;
    border-radius: 8px;
    border: none;
    font-size: 12px;
}

.input-box button {
    width: 100px;
    padding: 6px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background: rgba(255,255,255,0.2);
    color: white;
    font-size: 12px;
}

.post-card {
    width: 90%;
    margin: 15px auto;
    background: rgba(255,255,255,0.07);
    border-radius:14px;
    padding:12px;
    border:1px solid rgba(255,255,255,0.15);
    display:flex;
    flex-direction:column;
    gap:10px;
    font-size:12px;
    opacity:0;
    transform: translateY(20px);
    animation: fadeUp 0.6s ease forwards;
}

.post-img {
    width:100%;
    border-radius:10px;
}

.reaction-box {
    display:flex;
    gap:10px;
}

.like-btn, .dislike-btn, .delete-btn {
    padding:6px 12px;
    font-size:11px;
    border:none;
    border-radius:8px;
    background: rgba(255,255,255,0.12);
    color:white;
    cursor:pointer;
}

@keyframes fadeUp {
    from {opacity:0; transform:translateY(20px);}
    to {opacity:1; transform:translateY(0);}
}
</style>

</head>
<body>

<div class="slide-container">

<div class="summary-box" id="topBox">
Your posting section. Add content and images below.
</div>

<div class="input-box" id="inputBox">
    <input type="text" id="imgUrl" placeholder="Image URL (optional)" />
    <textarea id="postText" rows="3" placeholder="Write your post..."></textarea>
    <button id="postBtn">Post</button>
</div>

<div id="posts-container"></div>

<script>
/* ========== CREATOR SECURITY ========== */

const CREATOR_PASS = "@Boss";
let tapCount = 0;

const isCreator = () => {
  return localStorage.getItem("monthCreator") === "true" &&
         sessionStorage.getItem("monthSession") === "active";
};

const inputBox = document.getElementById("inputBox");
const topBox = document.getElementById("topBox");

if(isCreator()){
  inputBox.style.display = "flex";
}

topBox.addEventListener("click",()=>{
  tapCount++;
  if(tapCount === 5){
    tapCount = 0;
    const pass = prompt("Creator Password:");
    if(pass === CREATOR_PASS){
      localStorage.setItem("monthCreator","true");
      sessionStorage.setItem("monthSession","active");
      inputBox.style.display = "flex";
      alert("Creator mode enabled");
    } else {
      alert("Wrong password");
    }
  }
});

/* ========== POSTS LOGIC ========== */

const postsContainer = document.getElementById('posts-container');
const postBtn = document.getElementById('postBtn');
const imgInput = document.getElementById('imgUrl');
const textInput = document.getElementById('postText');
const STORAGE_KEY = "month_page_posts";

window.addEventListener("load",()=>{
  const saved = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
  saved.forEach(p => createPost(p.img, p.text, false));
});

function savePosts(){
  const posts = [];
  document.querySelectorAll(".post-card").forEach(card=>{
    const img = card.querySelector(".post-img");
    const text = card.querySelector(".post-text").innerText;
    posts.push({ img: img ? img.src : "", text });
  });
  localStorage.setItem(STORAGE_KEY, JSON.stringify(posts));
}

function createPost(imgSrc, text, save=true){
  if(!text.trim()) return;

  const card = document.createElement("div");
  card.className = "post-card";

  card.innerHTML = `
    ${imgSrc ? `<img src="${imgSrc}" class="post-img" loading="lazy">` : ""}
    <div class="post-text">${text}</div>
    <div class="reaction-box">
      <button class="like-btn">üëç Like</button>
      <button class="dislike-btn">üëé Dislike</button>
      ${isCreator() ? `<button class="delete-btn">üóë</button>` : ""}
    </div>
  `;

  if(isCreator()){
    card.querySelector(".delete-btn").onclick = ()=>{
      card.remove();
      savePosts();
    };
  }

  postsContainer.prepend(card);
  if(save) savePosts();
}

postBtn.onclick = ()=>{
  if(!isCreator()) return;
  createPost(imgInput.value.trim(), textInput.value.trim(), true);
  imgInput.value="";
  textInput.value="";
};
</script>

</div>

<!-- üî• Firebase visit counter untouched -->
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-storage-compat.js"></script>

<script>
  // Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyB9bgMrAdjNKet_RIzI0msXsQGdkLH3ZiM",
    authDomain: "animeunity-30c1f.firebaseapp.com",
    databaseURL: "https://animeunity-30c1f-default-rtdb.firebaseio.com",
    projectId: "animeunity-30c1f",
    storageBucket: "animeunity-30c1f.firebasestorage.app",
    messagingSenderId: "462600107764",
    appId: "1:462600107764:web:ae3d62c1c029e6190810a1",
    measurementId: "G-R08681NZBW"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database(); // Realtime Database
  const storage = firebase.storage(); // For images
</script>


</body>
</html>
